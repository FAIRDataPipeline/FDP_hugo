<!DOCTYPE html>
<html data-scroll='0' lang="en" dir=ZgotmplZ >

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="fair CLI outline # DISCLAIMER: The following document is largely conceptual and therefore does not represent a manual for the final interface. Statements within the following are likely to change, further details of possible changes are given throughout. Please either open an issue or pull request on the source repository raising any changes/issues. FAIR-CLI forms the main interface for synchronising changes between your local and shared remote FAIR Data Pipeline registries, it is also used to instantiate model runs/data submissions to the pipeline.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="FAIR CLI readme" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.fairdatapipeline.org/docs/interface/fair_cli_dev/" />

<title>FAIR CLI readme | FAIRDataPipeline</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.6cadb488be70926c21eb85dbe7b904cae7b12a25881b3e44aa9f69d9fe7e5435.css" integrity="sha256-bK20iL5wkmwh64Xb57kEyuexKiWIGz5Eqp9p2f5&#43;VDU=">
<script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk="></script>
<link rel="alternate" type="application/rss+xml" href="https://www.fairdatapipeline.org/docs/interface/fair_cli_dev/index.xml" title="FAIRDataPipeline" />
<!--
Made with Book Theme
https://github.com/RyanJField/hugo-book
-->
  
  
<script defer type="text/javascript" src="/lunr.min.js"></script>

<script defer src="/en.fancy-search.min.6bf768864f805238cc2c1e4256cec14ea34d30dd665f454c0b3811aba0f00079.js" integrity="sha256-a/dohk&#43;AUjjMLB5CVs7BTqNNMN1mX0VMCzgRq6DwAHk="></script>
<script defer src="/scroll.js"></script>
</head>

<body dir=ZgotmplZ>
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />

  
  <div class="custom-header">  
    <div class="custom-flex container flex">
      <div class="custom-left">
        <div class="custom-brand">
          <h2 class="custom-brand-text">
            <a href="/"><img src="/logo.jpg" alt="Logo" /><span>FAIRDataPipeline</span>
            </a>
          </h2>
          </div> 
        </div>  
      <div class ="custom-search-container">
        
<div class="search-top">
    <div class="search">
        <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search FAIRDataPipeline" aria-label="Search FAIRDataPipeline" autocomplete="off">
            <label for="search-input" class="search-label">
              <div class="search-svg">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
                <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </div>
            </label>
        </div>
        <div id="search-results" class="search-results"></div>
    </div>
</div>

      </div>
    </div>    
  </div>
  

  <main class="container flex">
    <aside class="book-menu">
      
  <nav>













  



  
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/quick_start/" class="">Quick Start</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/interface/" class="collapsed ">API Interface</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/interface/config/" class="">config.yaml fields</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/interface/example0/" class="">DPAPI examples</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/interface/example1/" class="">DPAPI functions</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/interface/fdp/" class="">FAIR CLI functions</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/interface/fair_cli_dev/" class="active">FAIR CLI readme</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/data_registry/" class="collapsed ">FAIR Data Registry</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sync_notes/" class="">Notes on synchronisation</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/API/" class="collapsed ">Modelling APIs</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/jargon_buster/" class="">Jargon buster</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/repository_status/" class="">Repository Status</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/use_cases/" class="collapsed ">Uses cases</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/SCRC/" class="">SCRC</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/edit-site/" class="">Edit this site</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
  </ul>
  











  
<ul>
  
  <li>
    <a href="https://www.gla.ac.uk/research/az/scrc/" target="_blank" rel="noopener">
        SCRC UoG
      </a>
  </li>
  
  <li>
    <a href="https://data.fairdatapipeline.org/" target="_blank" rel="noopener">
        Remote Data Registry
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>FAIR CLI readme</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>

  
  <aside class="hidden clearfix">
    
  <nav id="TableOfContents">
  <ul>
    <li><a href="#fair-cli-outline"><code>fair</code> CLI outline</a>
      <ul>
        <li><a href="#installation">Installation</a></li>
        <li><a href="#structure">Structure</a>
          <ul>
            <li><a href="#global-and-local-directories">Global and Local Directories</a></li>
            <li><a href="#data-directory">Data Directory</a></li>
            <li><a href="#sessions-directory">Sessions Directory</a></li>
            <li><a href="#logs-directory">Logs Directory</a></li>
            <li><a href="#staging-file">Staging File</a></li>
            <li><a href="#configyaml"><code>config.yaml</code></a></li>
          </ul>
        </li>
        <li><a href="#registry-interaction">Registry Interaction</a></li>
        <li><a href="#command-line-usage">Command Line Usage</a>
          <ul>
            <li><a href="#init"><code>init</code></a></li>
            <li><a href="#run"><code>run</code></a></li>
            <li><a href="#pull"><code>pull</code></a></li>
            <li><a href="#purge"><code>purge</code></a></li>
            <li><a href="#registry"><code>registry</code></a></li>
            <li><a href="#log"><code>log</code></a></li>
            <li><a href="#view"><code>view</code></a></li>
          </ul>
        </li>
        <li><a href="#template-variables">Template Variables</a></li>
      </ul>
    </li>
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="fair-cli-outline">
  <code>fair</code> CLI outline
  <a class="anchor" href="#fair-cli-outline">#</a>
</h1>
<table>
<thead>
<tr>
<th><strong>DISCLAIMER:</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>The following document is largely conceptual and therefore does <em>not</em> represent a manual for the final interface. Statements within the following are likely to change, further details of possible changes are given throughout. Please either open an issue or pull request on the 
  <a href="https://github.com/FAIRDataPipeline/FAIR-CLI">source repository</a> raising any changes/issues.</td>
</tr>
</tbody>
</table>
<p>FAIR-CLI forms the main interface for synchronising changes between your local and shared remote FAIR Data Pipeline registries, it is also used to instantiate model runs/data submissions to the pipeline.</p>
<p>The project is still under development with many features still to be implemented and checked. Available commands are summarised below along with their usage.</p>
<h2 id="installation">
  Installation
  <a class="anchor" href="#installation">#</a>
</h2>
<p>The project makes use of 
  <a href="https://python-poetry.org/">Poetry</a> for development which allows quick and easy mangement of dependencies, and provides a virtual environment exclusive to the project. Ultimately the project will be built into a pip installable module (using <code>poetry build</code>) meaning users will not need Poetry. You can access this environment by installing poetry:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install poetry
</span></span></code></pre></div><p>and, ensuring you are in the project repository, running:</p>
<pre tabindex="0"><code>poetry install
</code></pre><p>which will setup the virtual environment and install requirements. You can then either launch the environment as a shell using:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">poetry shell
</span></span></code></pre></div><p>or run commands within it externally using:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">poetry run &lt;command&gt;
</span></span></code></pre></div><h2 id="structure">
  Structure
  <a class="anchor" href="#structure">#</a>
</h2>
<p>The layout of FAIR-CLI on a simplified system looks like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">$HOME</span>
</span></span><span class="line"><span class="cl">├── .fair
</span></span><span class="line"><span class="cl">│   ├── cli
</span></span><span class="line"><span class="cl">│   │   ├── cli-config.yaml
</span></span><span class="line"><span class="cl">│   │   └── sessions
</span></span><span class="line"><span class="cl">│   ├── data
</span></span><span class="line"><span class="cl">│   │   └── <span class="nb">jobs</span>
</span></span><span class="line"><span class="cl">│   └── <span class="nv">$REGISTRY_HOME</span>
</span></span><span class="line"><span class="cl">│
</span></span><span class="line"><span class="cl">└─ Documents
</span></span><span class="line"><span class="cl">   └─ my_project
</span></span><span class="line"><span class="cl">      ├── config.yaml
</span></span><span class="line"><span class="cl">      └── .fair
</span></span><span class="line"><span class="cl">          ├── cli-config.yaml
</span></span><span class="line"><span class="cl">          ├── logs
</span></span><span class="line"><span class="cl">          └── staging
</span></span></code></pre></div><h3 id="global-and-local-directories">
  Global and Local Directories
  <a class="anchor" href="#global-and-local-directories">#</a>
</h3>
<p>FAIR-CLI stores information for projects in two locations. The first is a <em>global</em> directory stored in the user&rsquo;s home folder in the same location as the registry itself <code>$HOME/.fair/cli</code>, and the second is a <em>local</em> directory which exists within the model project itself <code>$PROJECT_HOME/.fair</code>.</p>
<p>The CLI holds metadata for the user in it&rsquo;s own configuration file (not to be confused with the user modifiable <code>config.yaml</code>), <code>cli-config.yaml</code>, the <em>global</em> version of which is initialised during first use. In a manner similar to <code>git</code>, FAIR-CLI has repositories which allow the user to override these <em>global</em> configurations, this then forming a <em>local</em> variant.</p>
<h3 id="data-directory">
  Data Directory
  <a class="anchor" href="#data-directory">#</a>
</h3>
<p>The directory <code>$HOME/.fair/data</code> is the default data store initialised by FAIR-CLI. During setup an alternative can be provided and this can be later changed on a per-run basis if the user so desires. The subdirectory <code>$HOME/data/jobs</code> contains timestamped directories of jobs.</p>
<h3 id="sessions-directory">
  Sessions Directory
  <a class="anchor" href="#sessions-directory">#</a>
</h3>
<p>The directory <code>$HOME/.fair/sessions</code> is used to keep track of ongoing queries to the registry as a safety mechanism to ensure the registry is not shutdown whilst processes are still occuring.</p>
<h3 id="logs-directory">
  Logs Directory
  <a class="anchor" href="#logs-directory">#</a>
</h3>
<p>The directory <code>$PROJECT/.fair/logs</code> stores <code>stdout</code> logs for jobs also giving information on who launched the job and how long it lasted.</p>
<h3 id="staging-file">
  Staging File
  <a class="anchor" href="#staging-file">#</a>
</h3>
<p>The staging file, <code>$PROJECT/.fair/staging</code>, contains information of what jobs are being tracked, by default all jobs are added to this file after completion and are set to &ldquo;unstaged&rdquo;.
Simply contains a dictionary of booleans where items for sync (staged) are marked true <code>True</code> and those to be held only locally <code>False</code>.
The file uses paths relative to the <em>local</em> <code>.fair</code> folder as keys, to behave in a manner identical to <code>git</code> staging.</p>
<h3 id="configyaml">
  <code>config.yaml</code>
  <a class="anchor" href="#configyaml">#</a>
</h3>
<p>This is the main file the user will interact with to customise their run. FAIR-CLI automatically generates a starter version of this file with everything in place. The only addition required is setting of either <code>script</code> or <code>script_path</code> (with the exception of running using <code>fair run bash</code> - see 
  <a href="/#run">below</a>) under <code>run_metadata</code>.</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>script</code></strong></td>
</tr>
<tr>
<td>This should be a command callable by a shell for running a model/submitting data to the registry. This script is saved to a file prior to execution.</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td><strong><code>script_path</code></strong></td>
</tr>
<tr>
<td>This is a direct path to an existing script to use for submission.</td>
</tr>
</tbody>
</table>
<p>By default the shell used will be <code>sh</code> or <code>pwsh</code> for UNIX and Windows systems respectively, however this can be overwritten with the optional <code>shell</code> key which recognises the following values (where <code>{0}</code> is the script file):</p>
<table>
<thead>
<tr>
<th><strong>Shell</strong></th>
<th><strong>Command</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bash</code></td>
<td><code>bash -eo pipefail {0}</code></td>
</tr>
<tr>
<td><code>java</code></td>
<td><code>java {0}</code></td>
</tr>
<tr>
<td><code>julia</code></td>
<td><code>julia {0}</code></td>
</tr>
<tr>
<td><code>powershell</code></td>
<td><code>powershell -command &quot;. '{0}'&quot;</code></td>
</tr>
<tr>
<td><code>pwsh</code></td>
<td><code>pwsh -command &quot;. '{0}'&quot;</code></td>
</tr>
<tr>
<td><code>python2</code></td>
<td><code>python2 {0}</code></td>
</tr>
<tr>
<td><code>python3</code></td>
<td><code>python3 {0}</code></td>
</tr>
<tr>
<td><code>python</code></td>
<td><code>python {0}</code></td>
</tr>
<tr>
<td><code>R</code></td>
<td><code>R -f {0}</code></td>
</tr>
<tr>
<td><code>sh</code></td>
<td><code>sh -e {0}</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><strong>NOTE</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>This layout is subject to possible change depending on whether or not multiple aliases for the same user will be allowed in the registry itself. The main reason for having a <em>local</em> version is to support separate handling of multiple projects.</td>
</tr>
</tbody>
</table>
<h2 id="registry-interaction">
  Registry Interaction
  <a class="anchor" href="#registry-interaction">#</a>
</h2>
<p>Currently <code>FAIR-CLI</code> sets up the write data storage location on the local registry if it does not exist. Entries are created for the YAML file type, current user as an author, and object for a given run.</p>
<h2 id="command-line-usage">
  Command Line Usage
  <a class="anchor" href="#command-line-usage">#</a>
</h2>
<p>As mentioned, all of the subcommands within FAIR-CLI are still under review with many still serving as placeholders for future features. Running <code>fair</code> without arguments or <code>fair --help</code> will show all of these.</p>
<h3 id="init">
  <code>init</code>
  <a class="anchor" href="#init">#</a>
</h3>
<p>Initialises a new FAIR repository within the given directory. This should ideally be the same location as the <code>.git</code> folder for the current project, although setup will ask if you want to use an alternative location. The command will ask the user a series of questions which will provide metadata for tracking run authors, and also allow for the creation of a starter <code>config.yaml</code>.</p>
<p>The first time this command is launched the <em>global</em> CLI configuration will be populated. In subsequent calls the <em>global</em> will provide default suggestions towards creating the CLI configuration for the repository (<em>local</em>).</p>
<p>A repository directory matching the structure above will be placed in the current location and a starter <code>config.yaml</code> file will be generated (see below).</p>
<p><strong>Example: First call to <code>fair init</code></strong></p>
<p>This example shows the process of setting up for the first time. Note the default suggestions for each prompt, in the case of <code>Full name</code> and <code>Default output namespace</code> this is the hostname of the system and an abbreviated version of this name.</p>
<pre tabindex="0"><code>$ fair init
Initialising FAIR repository, setup will now ask for basic info:

Checking for local registry
Local registry found
Remote API URL: http://data.fairdatapipeline.org/api/
Remote Data Storage Root [http://data.fairdatapipeline.org/data/]: 
Remote API Token File: $HOME/scrc_token.txt
Local API URL [http://localhost:8000/api/]: 
Local registry is offline, would you like to start it? [y/N]: y
Default Data Store:  [/home/joebloggs/.fair/data]: 
Email: jbloggs@noreply.uk
ORCID [None]: 
Full Name: Joe Bloggs
Default input namespace [None]: SCRC
Default output namespace [jbloggs]: 
Project description: Test project
Local Git repository [/home/joebloggs/Documents/AnalysisProject]: 
Git remote name [origin]: 
Using git repository remote &#39;origin&#39;: git@notagit.com:jbloggs/AnalysisProject.git
Initialised empty fair repository in /home/joebloggs/Documents/AnalysisProject/.fair
</code></pre><p><strong>Example: Subsequent runs</strong></p>
<p>In subsequent runs the first time setup will provide further defaults.</p>
<pre tabindex="0"><code>$ fair init
Initialising FAIR repository, setup will now ask for basic info:

Project description: Test Project
Local Git repository [/home/joebloggs/Documents/AnalysisProject]: 
Git remote name [origin]: 
Using git repository remote &#39;origin&#39;: git@nogit.com:joebloggs/AnalysisProject.git
Remote API URL [http://data.fairdatapipeline.org/api/]: 
Remote API Token File [/home/kristian/scrc_token.txt]: 
Local API URL [http://localhost:8000/api/]: 
Default output namespace [jbloggs]: 
Default input namespace [SCRC]: 
Initialised empty fair repository in /home/joebloggs/Documents/AnalysisProject/.fair
</code></pre><p><strong>Generated <code>config.yaml</code></strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">run_metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">default_input_namespace</span><span class="p">:</span><span class="w"> </span><span class="l">SCRC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">default_output_namespace</span><span class="p">:</span><span class="w"> </span><span class="l">jbloggs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Test Project</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">local_data_registry</span><span class="p">:</span><span class="w"> </span><span class="l">http://localhost:8000/api/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">local_repo</span><span class="p">:</span><span class="w"> </span><span class="l">/home/joebloggs/Documents/AnalysisProject</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">write_data_store</span><span class="p">:</span><span class="w"> </span><span class="l">/home/joebloggs/.fair/data</span><span class="w">
</span></span></span></code></pre></div><p>the user then only needs to add a <code>script</code> or <code>script_path</code> entry to execute a code run. This is only required for <code>run</code>.</p>
<h3 id="run">
  <code>run</code>
  <a class="anchor" href="#run">#</a>
</h3>
<p>The purpose of <code>run</code> is to execute a model/submission run to the local registry. The command fills any specified template variables of the form <code>${{ VAR }}</code> to match those outlined 
  <a href="/#template-variables">below</a>. Outputs of a run will be stored within the <code>coderun</code> folder in the directory specified under the <code>data_store</code> tag in the <code>config.yaml</code>, by default this is <code>$HOME/.fair/data/coderun</code>.</p>
<pre tabindex="0"><code>fair run
</code></pre><p>If you wish to use an alternative <code>config.yaml</code> then specify it as an additional argument:</p>
<pre tabindex="0"><code>fair run /path/to/config.yaml
</code></pre><p>You can also launch a bash command directly which will then be automatically written into the <code>config.yaml</code> for you:</p>
<pre tabindex="0"><code>fair run --script &#34;echo \&#34;Hello World\&#34;&#34;
</code></pre><p>note the command itself must be quoted as it is a single argument.</p>
<h3 id="pull">
  <code>pull</code>
  <a class="anchor" href="#pull">#</a>
</h3>
<p>Currently <code>pull</code> will update any entries within the <code>config.yaml</code> under the <code>register</code> heading creating <code>external_object</code> and <code>data_product</code> objects on the registry and downloading the data to the local data storage. For example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">run_metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">default_input_namespace</span><span class="p">:</span><span class="w"> </span><span class="l">SCRC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">default_output_namespace</span><span class="p">:</span><span class="w"> </span><span class="l">jbloggs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Test project</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">local_data_registry</span><span class="p">:</span><span class="w"> </span><span class="l">http://localhost:8000/api/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">local_repo</span><span class="p">:</span><span class="w"> </span><span class="l">/home/joebloggs/Documents/SCRC/FAIR-CLI</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">write_data_store</span><span class="p">:</span><span class="w"> </span><span class="l">/home/joebloggs/.fair/data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">register</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">external_object</span><span class="p">:</span><span class="w"> </span><span class="l">records/SARS-CoV-2/scotland/human-mortality</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace_name</span><span class="p">:</span><span class="w"> </span><span class="l">Scottish Government Open Data Repository</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace_full_name</span><span class="p">:</span><span class="w"> </span><span class="l">Scottish Government Open Data Repository</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace_website</span><span class="p">:</span><span class="w"> </span><span class="l">https://statistics.gov.scot/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">root</span><span class="p">:</span><span class="w"> </span><span class="l">https://statistics.gov.scot/sparql.csv?query=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="p">|-</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">    PREFIX qb: &lt;http://purl.org/linked-data/cube#&gt;
</span></span></span><span class="line"><span class="cl"><span class="sd">    PREFIX data: &lt;http://statistics.gov.scot/data/&gt;
</span></span></span><span class="line"><span class="cl"><span class="sd">    PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
</span></span></span><span class="line"><span class="cl"><span class="sd">    PREFIX dim: &lt;http://purl.org/linked-data/sdmx/2009/dimension#&gt;
</span></span></span><span class="line"><span class="cl"><span class="sd">    PREFIX sdim: &lt;http://statistics.gov.scot/def/dimension/&gt;
</span></span></span><span class="line"><span class="cl"><span class="sd">    PREFIX stat: &lt;http://statistics.data.gov.uk/def/statistical-entity#&gt;
</span></span></span><span class="line"><span class="cl"><span class="sd">    PREFIX mp: &lt;http://statistics.gov.scot/def/measure-properties/&gt;
</span></span></span><span class="line"><span class="cl"><span class="sd">    SELECT ?featurecode ?featurename ?areatypename ?date ?cause ?location ?gender ?age ?type ?count
</span></span></span><span class="line"><span class="cl"><span class="sd">    WHERE {
</span></span></span><span class="line"><span class="cl"><span class="sd">     ?indicator qb:dataSet data:deaths-involving-coronavirus-covid-19;
</span></span></span><span class="line"><span class="cl"><span class="sd">       mp:count ?count;
</span></span></span><span class="line"><span class="cl"><span class="sd">       qb:measureType ?measType;
</span></span></span><span class="line"><span class="cl"><span class="sd">       sdim:age ?value;
</span></span></span><span class="line"><span class="cl"><span class="sd">       sdim:causeOfDeath ?causeDeath;
</span></span></span><span class="line"><span class="cl"><span class="sd">       sdim:locationOfDeath ?locDeath;
</span></span></span><span class="line"><span class="cl"><span class="sd">       sdim:sex ?sex;
</span></span></span><span class="line"><span class="cl"><span class="sd">       dim:refArea ?featurecode;
</span></span></span><span class="line"><span class="cl"><span class="sd">       dim:refPeriod ?period.
</span></span></span><span class="line"><span class="cl"><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">       ?measType rdfs:label ?type.
</span></span></span><span class="line"><span class="cl"><span class="sd">       ?value rdfs:label ?age.
</span></span></span><span class="line"><span class="cl"><span class="sd">       ?causeDeath rdfs:label ?cause.
</span></span></span><span class="line"><span class="cl"><span class="sd">       ?locDeath rdfs:label ?location.
</span></span></span><span class="line"><span class="cl"><span class="sd">       ?sex rdfs:label ?gender.
</span></span></span><span class="line"><span class="cl"><span class="sd">       ?featurecode stat:code ?areatype;
</span></span></span><span class="line"><span class="cl"><span class="sd">         rdfs:label ?featurename.
</span></span></span><span class="line"><span class="cl"><span class="sd">       ?areatype rdfs:label ?areatypename.
</span></span></span><span class="line"><span class="cl"><span class="sd">       ?period rdfs:label ?date.
</span></span></span><span class="line"><span class="cl"><span class="sd">    }</span><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">Deaths involving COVID19</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Nice description of the dataset</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">unique_name</span><span class="p">:</span><span class="w"> </span><span class="l">Scottish deaths involving COVID19</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">file_type</span><span class="p">:</span><span class="w"> </span><span class="l">csv</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">release_date</span><span class="p">:</span><span class="w"> </span><span class="l">${{DATETIME}}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="l">.${{DATE}}.0       </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">primary</span><span class="p">:</span><span class="w"> </span><span class="kc">True</span><span class="w">
</span></span></span></code></pre></div><p>if run on <code>10/10/2021</code> would download the data from the given <code>root</code>/<code>path</code> URL and store in a file:</p>
<pre tabindex="0"><code>/home/joebloggs/.fair/data/records/SARS-CoV-2/scotland/human-mortality/0.20211010.0.csv
</code></pre><p>and register all required objects into the local registry.</p>
<h3 id="purge">
  <code>purge</code>
  <a class="anchor" href="#purge">#</a>
</h3>
<p>Removes the local <code>.fair</code> (FAIR repository) folder by default so the user can reinitialise:</p>
<pre tabindex="0"><code>fair purge
</code></pre><p>You can remove the global configuration and start again entirely by running:</p>
<pre tabindex="0"><code>fair purge --glob
</code></pre><p>you will be asked if you wish to erase the data store, do not do this unless you intend on reinstalling the registry itself.</p>
<h3 id="registry">
  <code>registry</code>
  <a class="anchor" href="#registry">#</a>
</h3>
<p>By default the CLI will launch the registry whenever a synchronisation or run is called. The server will only be halted once all ongoing CLI processes (in the case of multiple parallel calls) have been completed.</p>
<p>However the user may also specify a manual launch that will override this behaviour, instead leaving the server running constantly allowing them to view the registry in the browser.</p>
<p>The commands:</p>
<pre tabindex="0"><code>fair registry start
</code></pre><p>and</p>
<pre tabindex="0"><code>fair registry stop
</code></pre><p>will launch and halt the server respectively.</p>
<h3 id="log">
  <code>log</code>
  <a class="anchor" href="#log">#</a>
</h3>
<p>Runs are logged locally within the local FAIR repository. A full list of runs is shown by running:</p>
<pre tabindex="0"><code>fair log
</code></pre><p>This will present a list of runs in a summary analogous to a <code>git log</code> call:</p>
<pre tabindex="0"><code>run 0db35c20946a1ebeaafdc3b30103cd74a57eb6b6
Author: Joe Bloggs &lt;jbloggs@noreply.uk&gt;
Date:   Wed Jun 30 09:09:30 2021
</code></pre><table>
<thead>
<tr>
<th><strong>NOTE</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>The SHA for a job is <em>not</em> yet related to a registry code run identifier as multiple code runs can be executed within a single job.</td>
</tr>
</tbody>
</table>
<h3 id="view">
  <code>view</code>
  <a class="anchor" href="#view">#</a>
</h3>
<p>To view the <code>stdout</code> of a run given its SHA as shown by running <code>fair log</code> use the command:</p>
<pre tabindex="0"><code>fair view &lt;sha&gt;
</code></pre><p>you do not need to specify the full SHA but rather the first few characters:</p>
<pre tabindex="0"><code>--------------------------------
 Commenced = Wed Jun 30 09:09:30 2021 
 Author    = Joe Bloggs &lt;jbloggs@noreply.uk&gt;
 Namespace = jbloggs
 Command   = bash -eo pipefail /home/jbloggs/.fair/data/coderun/2021-06-30_09_09_30_721358/run_script
--------------------------------
0
1
2
3
4
5
6
7
8
9
10
------- time taken 0:00:00.011910 -------
</code></pre><h2 id="template-variables">
  Template Variables
  <a class="anchor" href="#template-variables">#</a>
</h2>
<p>Within the <code>config.yaml</code> file, template variables can be specified by using the notation <code>${{ VAR }}</code>, the following variables are currently recognised:</p>
<table>
<thead>
<tr>
<th><strong>Variable</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DATE</code></td>
<td>Date in the form <code>%Y%m%d</code></td>
</tr>
<tr>
<td><code>DATETIME</code></td>
<td>Date and time in the form <code>%Y-%m-%sT%H:%M:S</code></td>
</tr>
<tr>
<td><code>DATETIME-%Y%H%M</code></td>
<td>Date and time in custom format (where <code>%Y%H%M</code> can be any valid form)</td>
</tr>
<tr>
<td><code>USER</code></td>
<td>The current user as defined in the CLI</td>
</tr>
<tr>
<td><code>REPO_DIR</code></td>
<td>The FAIR repository root directory</td>
</tr>
<tr>
<td><code>CONFIG_DIR</code></td>
<td>The directory containing the <code>config.yaml</code> after template substitution</td>
</tr>
<tr>
<td><code>SOURCE_CONFIG</code></td>
<td>Path of the user defined <code>config.yaml</code></td>
</tr>
<tr>
<td><code>GIT_BRANCH</code></td>
<td>Current branch of the <code>git</code> repository</td>
</tr>
<tr>
<td><code>GIT_REMOTE</code></td>
<td>The URI of the git repository specified during setup</td>
</tr>
<tr>
<td><code>GIT_TAG</code></td>
<td>The latest tag on <code>git</code></td>
</tr>
</tbody>
</table>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">



  <div><a class="flex align-center" href="https://github.com/FAIRDataPipeline/FDP_hugo/commit/98a4cff67013aa42c582e50bca175fab8575844d" title='Last modified by Kristian Zarębski | August 18, 2021' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>August 18, 2021</span>
    </a>
  </div>



  <div>
    <a class="flex align-center" href="https://github.com/FAIRDataPipeline/FDP_hugo/tree/master/content//docs/interface/fair_cli_dev/_index.md" target="_blank" rel="noopener">
      <img src="/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>

</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#fair-cli-outline"><code>fair</code> CLI outline</a>
      <ul>
        <li><a href="#installation">Installation</a></li>
        <li><a href="#structure">Structure</a>
          <ul>
            <li><a href="#global-and-local-directories">Global and Local Directories</a></li>
            <li><a href="#data-directory">Data Directory</a></li>
            <li><a href="#sessions-directory">Sessions Directory</a></li>
            <li><a href="#logs-directory">Logs Directory</a></li>
            <li><a href="#staging-file">Staging File</a></li>
            <li><a href="#configyaml"><code>config.yaml</code></a></li>
          </ul>
        </li>
        <li><a href="#registry-interaction">Registry Interaction</a></li>
        <li><a href="#command-line-usage">Command Line Usage</a>
          <ul>
            <li><a href="#init"><code>init</code></a></li>
            <li><a href="#run"><code>run</code></a></li>
            <li><a href="#pull"><code>pull</code></a></li>
            <li><a href="#purge"><code>purge</code></a></li>
            <li><a href="#registry"><code>registry</code></a></li>
            <li><a href="#log"><code>log</code></a></li>
            <li><a href="#view"><code>view</code></a></li>
          </ul>
        </li>
        <li><a href="#template-variables">Template Variables</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>











