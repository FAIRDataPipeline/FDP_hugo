<!DOCTYPE html>
<html data-scroll='0' lang="en" dir=ZgotmplZ >

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="API # The API is defined more in terms of file formats than it is in terms of data types. There are two file formats that are native to the data pipeline, and files in these formats are referred to as data products: TOML files, and HDF5 files. TOML files store “small” parameter data, representing individual parameters. HDF5 files are used to store structured data, encoded either as “arrays” or “tables”.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Modelling APIs" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.fairdatapipeline.org/docs/API/" />

<title>Modelling APIs | FAIRDataPipeline</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.6cadb488be70926c21eb85dbe7b904cae7b12a25881b3e44aa9f69d9fe7e5435.css" integrity="sha256-bK20iL5wkmwh64Xb57kEyuexKiWIGz5Eqp9p2f5&#43;VDU=">
<script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk="></script>
<link rel="alternate" type="application/rss+xml" href="https://www.fairdatapipeline.org/docs/API/index.xml" title="FAIRDataPipeline" />
<!--
Made with Book Theme
https://github.com/RyanJField/hugo-book
-->
  
  
<script defer type="text/javascript" src="/lunr.min.js"></script>

<script defer src="/en.fancy-search.min.4a58a920302aa7c71df1f5e3e5cb785995e44802acb1685a2c143af85e81b793.js" integrity="sha256-SlipIDAqp8cd8fXj5ct4WZXkSAKssWhaLBQ6&#43;F6Bt5M="></script>
<script defer src="/scroll.js"></script>
</head>

<body dir=ZgotmplZ>
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />

  
  <div class="custom-header">  
    <div class="custom-flex container flex">
      <div class="custom-left">
        <div class="custom-brand">
          <h2 class="custom-brand-text">
            <a href="/"><img src="/logo.jpg" alt="Logo" /><span>FAIRDataPipeline</span>
            </a>
          </h2>
          </div> 
        </div>  
      <div class ="custom-search-container">
        
<div class="search-top">
    <div class="search">
        <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search FAIRDataPipeline" aria-label="Search FAIRDataPipeline" autocomplete="off">
            <label for="search-input" class="search-label">
              <div class="search-svg">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
                <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </div>
            </label>
        </div>
        <div id="search-results" class="search-results"></div>
    </div>
</div>

      </div>
    </div>    
  </div>
  

  <main class="container flex">
    <aside class="book-menu">
      
  <nav>













  



  
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/quick_start/" class="">Quick Start</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/cli/" class="collapsed ">Fair CLI</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/data_registry/" class="collapsed ">FAIR Data Registry</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/sync_notes/" class="">Notes on synchronisation</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/API/" class="collapsed active">Modelling APIs</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/API/R/" class="">R</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/API/julia/" class="">Julia</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/API/python/" class="collapsed ">Python</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/API/Java/" class="collapsed ">Java</a>
  

          
  
  
  

  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/jargon_buster/" class="">Jargon buster</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/repository_status/" class="">Repository Status</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/use_cases/" class="collapsed ">Uses cases</a>
  

          
  
  
  

  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/SCRC/" class="">SCRC</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/edit-site/" class="">Edit this site</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
  </ul>
  











  
<ul>
  
  <li>
    <a href="https://www.gla.ac.uk/research/az/scrc/" target="_blank" rel="noopener">
        SCRC UoG
      </a>
  </li>
  
  <li>
    <a href="https://data.fairdatapipeline.org/" target="_blank" rel="noopener">
        Remote Data Registry
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Modelling APIs</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>

  
  <aside class="hidden clearfix">
    
  <nav id="TableOfContents">
  <ul>
    <li><a href="#api">API</a>
      <ul>
        <li><a href="#initialisation">Initialisation</a></li>
        <li><a href="#additional-metadata-on-write">Additional metadata on write</a></li>
        <li><a href="#toml-parameter-files">TOML (parameter) files</a>
          <ul>
            <li><a href="#file-format">File format</a></li>
            <li><a href="#api-functions">API functions</a></li>
          </ul>
        </li>
        <li><a href="#hdf5-files">HDF5 files</a>
          <ul>
            <li><a href="#file-format-1">File format</a></li>
            <li><a href="#api-functions-1">API functions</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="api">
  API
  <a class="anchor" href="#api">#</a>
</h1>
<p>The API is defined more in terms of file formats than it is in terms of data types. There are two file formats that are native to the data pipeline, and files in these formats are referred to as <em>data products</em>: TOML files, and HDF5 files. TOML files store “small” parameter data, representing individual parameters. HDF5 files are used to store structured data, encoded either as “arrays” or “tables”. Both formats are described in more detail below, alongside API functions used to interact with them. Data in any other file format are treated as binary blobs, and are referred to as <em>external objects</em>.</p>
<p>Different metadata is stored about each &ndash; data products record information about their internal structure and naming of their components, whereas external objects record information about their provenance (since data products are internal to the pipeline, provenance is recorded separately). A single object can be both an external object and a data product, and thus have both sets of metadata recorded.</p>
<h2 id="initialisation">
  Initialisation
  <a class="anchor" href="#initialisation">#</a>
</h2>
<p>The API must be initialised with the model URI and git sha, which should then be set as run-level metadata.</p>
<h2 id="additional-metadata-on-write">
  Additional metadata on write
  <a class="anchor" href="#additional-metadata-on-write">#</a>
</h2>
<p>The write functions all accept <code>description</code> and <code>issues</code> arguments.</p>
<h2 id="toml-parameter-files">
  TOML (parameter) files
  <a class="anchor" href="#toml-parameter-files">#</a>
</h2>
<p>A parameter file contains representations of one or more parameters, each a single number, possibly with some associated uncertainty. Parameters may by represented as point-estimates, parametric distributions, and sample data.</p>
<h3 id="file-format">
  File format
  <a class="anchor" href="#file-format">#</a>
</h3>
<p>Parameters are stored in toml-formatted files, with the extension “toml”, containing sections corresponding to different components. The following is an example of the internal encoding, defining three components: &ldquo;<code>my-point-estimate</code>&rdquo;, &ldquo;<code>my-distribution</code>&rdquo;, and &ldquo;<code>my-samples</code>&rdquo;:</p>
<pre tabindex="0"><code>[my-point-estimate] 
type = &#34;point-estimate&#34; 
value = 0.1 

[my-distribution] 
type = &#34;distribution&#34; 
distribution = &#34;gamma&#34; 
shape = 1 
scale = 2 
 
[my-samples] 
type = &#34;samples&#34; 
samples = [1.0, 2.0, 3.0, 4.0, 5.0] 
</code></pre><p>Point estimates are used when our knowledge of the parameter is only sufficient for a single value, with no notion of uncertainty. A point estimate component must have type = &ldquo;point-estimate&rdquo; and a value that is either a float or an integer.</p>
<p>Distributions are used when our knowledge of a parameter can be represented by a parametric distribution. A distribution component must have type = &ldquo;distribution&rdquo;, a distribution set to a string name of the distribution, and other parameters determined by the distribution. The set of distributions required to be supported is currently undefined.</p>
<p>Samples are used when our knowledge of a parameter is represented by samples, from either empirical measurements, or a posterior distribution. A samples component must have type = &ldquo;samples&rdquo; and a value that is a list of floats and integers.</p>
<h4 id="distributions">
  Distributions
  <a class="anchor" href="#distributions">#</a>
</h4>
<p>The supported distributions,each with a link to information about their parameterisation, and their standardised parameter names are as follows:</p>
<table>
<thead>
<tr>
<th>Distribution</th>
<th>Standardised parameter names</th>
</tr>
</thead>
<tbody>
<tr>
<td>categorical (non-standard)</td>
<td>bins (string array), weights (float array)</td>
</tr>
<tr>
<td>gamma</td>
<td>k (float), theta (float)</td>
</tr>
<tr>
<td>normal</td>
<td>mu (float), sigma (float)</td>
</tr>
<tr>
<td>uniform</td>
<td>a (float), b (float)</td>
</tr>
<tr>
<td>poisson</td>
<td>lambda (float)</td>
</tr>
<tr>
<td>exponential</td>
<td>lambda (float)</td>
</tr>
<tr>
<td>beta</td>
<td>alpha (float), beta (float)</td>
</tr>
<tr>
<td>binomial</td>
<td>n (int), p (float)</td>
</tr>
<tr>
<td>multinomial</td>
<td>n (int), p (float array)</td>
</tr>
</tbody>
</table>
<h3 id="api-functions">
  API functions
  <a class="anchor" href="#api-functions">#</a>
</h3>
<p><code>read_estimate(data_product, component) -&gt; float or integer</code></p>
<p>If the component is represented as a point estimate, return that value.</p>
<p>If the component is represented as a distribution, return the distribution mean.</p>
<p>If the component is represented as samples, return the sample mean.</p>
<p><code>read_distribution(data_product, component) -&gt; distribution object</code></p>
<p>If the component is represented as a point estimate, fail.</p>
<p>If the component is represented as a distribution, return an object representing that distribution.</p>
<p>If the component is represented as samples, failreturn an empirical distribution.</p>
<p><code>read_samples(data_product, component) -&gt; list of floats or integers</code></p>
<p>If the component is represented as a point estimate, fail.</p>
<p>If the component is represented as a distribution, fail.</p>
<p>If the component is represented as samples, return the samples.</p>
<p><code>write_estimate(data_product, component, estimate, description, issues)</code></p>
<p><code>write_distribution(data_product, component, distribution object, description, issues)</code></p>
<p><code>write_samples(data_product, component, samples, description, issues)</code></p>
<h2 id="hdf5-files">
  HDF5 files
  <a class="anchor" href="#hdf5-files">#</a>
</h2>
<p><span style="font-size:12pt; color:red">Note that the following is subject to change. For example, we may want to add all of the metadata as attributes.</span></p>
<p>An HDF5 file can be either a table or an array. A table is always 2-dimentional and might typically be used when each column contains different classes of data (<em>e.g.</em> integers and strings). Conversely, all elements in an array should be the same class, though the array itself might be 1-dimensional, 2-dimensional, or more (<em>e.g.</em> a 3-dimensional array comprising population counts, with rows as area, columns as age, and a third dimension representing gender).</p>
<p>You should create a single HDF5 file for a single dataset. Unless you have a dataset that really should have been generated as multiple datasets in the first place (<em>e.g.</em> testing data mixed with carehome data), in which case use your own judgement.</p>
<p>HDF5 files contain structured data, encoded as either an “array”, or a “table”, both of which are described in more detail below.</p>
<h3 id="file-format-1">
  File format
  <a class="anchor" href="#file-format-1">#</a>
</h3>
<p>HDF5 files are stored with the extension “h5”. Internally, each component is stored in a different (possibly nested) group, where the full path defines the component name (<em>e.g.</em> “path/to/component”). Inside the group for each component is either a value named “array”, or a value named “table”. It is an error for there to be both.</p>
<h4 id="array-format">
  array format
  <a class="anchor" href="#array-format">#</a>
</h4>
<dl>
<dt>{component}/array</dt>
<dd>An n-dimensional array of numerical data</dd>
<dt>{component}/Dimension_{i}_title</dt>
<dd>The string name of dimension 
<link rel="stylesheet" href="/katex/katex.min.css" />
<script defer src="/katex/katex.min.js"></script>
<script defer src="/katex/auto-render.min.js" onload="renderMathInElement(document.body);"></script><span>
  \(i\)
</span>
</dd>
<dt>{component}/Dimension_{i}_names</dt>
<dd>String labels for dimension <span>
  \(i\)
</span>
</dd>
<dt>{component}/Dimension_{i}_values</dt>
<dd>Values for dimension <span>
  \(i\)
</span>
</dd>
<dt>{component}/Dimension_{i}_units</dt>
<dd>Units for dimension <span>
  \(i\)
</span>
</dd>
<dt>{component}/units</dt>
<dd>Units for the data in array</dd>
</dl>
<h4 id="table-format">
  table format
  <a class="anchor" href="#table-format">#</a>
</h4>
<dl>
<dt>{component}/table</dt>
<dd>A dataframe</dd>
<dt>{component}/row_names</dt>
<dd>String labels for the row axis</dd>
<dt>{component}/column_units</dt>
<dd>Units for the columns</dd>
</dl>
<h3 id="api-functions-1">
  API functions
  <a class="anchor" href="#api-functions-1">#</a>
</h3>
<p><code>read_array(data_product, component) -&gt; array</code></p>
<p>If the component does not terminate in an array-formatted value, raise an error.</p>
<p>Return an array, currently with no structural information.</p>
<p><code>read_table(data_product, component) -&gt; dataframe</code></p>
<p>If the component does not terminate in a table-formatted value, raise an error.</p>
<p>Return a dataframe, with labelled columns.</p>
<p><code>write_array(data_product, component, array, description, issues)</code></p>
<p>If the array argument is not array-formatted, raise an error.</p>
<p><code>write_table(data_product, component, table, description, issues)</code></p>
<p>If the table argument is not table-formatted, raise an error.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">



  <div><a class="flex align-center" href="https://github.com/FAIRDataPipeline/FDP_hugo/commit/496a0ccd959d414930612bd6e97d8e8f1ce7944a" title='Last modified by soniamitchell | July 13, 2021' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>July 13, 2021</span>
    </a>
  </div>



  <div>
    <a class="flex align-center" href="https://github.com/FAIRDataPipeline/FDP_hugo/tree/master/content//docs/API/_index.md" target="_blank" rel="noopener">
      <img src="/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>

</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#api">API</a>
      <ul>
        <li><a href="#initialisation">Initialisation</a></li>
        <li><a href="#additional-metadata-on-write">Additional metadata on write</a></li>
        <li><a href="#toml-parameter-files">TOML (parameter) files</a>
          <ul>
            <li><a href="#file-format">File format</a></li>
            <li><a href="#api-functions">API functions</a></li>
          </ul>
        </li>
        <li><a href="#hdf5-files">HDF5 files</a>
          <ul>
            <li><a href="#file-format-1">File format</a></li>
            <li><a href="#api-functions-1">API functions</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>











